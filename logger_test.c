#include <stdio.h>
#include <string.h>
#include <pthread.h>
#include "logger.h"

void *l;

static void *test_thread(void *data) {
   log_it(l, 0, "message: %s", "123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890");
   log_it(l, 0, "message: (none)");
   return NULL;
}

int main(int argv, void *argc[]) {

   pthread_t tid1;
   pthread_t tid2;
   pthread_t tid3;
   pthread_t tid4;
   pthread_t tid5;
   pthread_t tid6;
   pthread_t tid7;

   l = open_logger("its_me", 16, 0, LOGGER_UDP, "localhost", "514");

   pthread_create(&tid1, NULL, (void *(*)(void *))test_thread, NULL);
   pthread_create(&tid2, NULL, (void *(*)(void *))test_thread, NULL);
   pthread_create(&tid3, NULL, (void *(*)(void *))test_thread, NULL);
   pthread_create(&tid4, NULL, (void *(*)(void *))test_thread, NULL);
   pthread_create(&tid5, NULL, (void *(*)(void *))test_thread, NULL);
   pthread_create(&tid6, NULL, (void *(*)(void *))test_thread, NULL);
   pthread_create(&tid7, NULL, (void *(*)(void *))test_thread, NULL);

   pthread_join(tid1, NULL);
   pthread_join(tid2, NULL);
   pthread_join(tid3, NULL);
   pthread_join(tid4, NULL);
   pthread_join(tid5, NULL);
   pthread_join(tid6, NULL);
   pthread_join(tid7, NULL);

   log_it(l, 0, "message: %s", "123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890");
   log_it(l, 0, "message: (none)");

   close_logger(l);

   return 0;
}